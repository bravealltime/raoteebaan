(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724,945],{753:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var r=a(7876),l=a(4836),o=a(5377),s=a(8443),n=a(851),i=a(9803),u=a(9955),c=a(2736),d=a(1921),h=a(4232),x=a(3611),f=a(2964),b=a(9099);a(9473),a(7085),a(4312);var p=a(9917),m=a(6447);function g(){let[e,t]=(0,h.useState)([]),[a,g]=(0,h.useState)(!0),[y,v]=(0,h.useState)(null),[S,j]=(0,h.useState)(!1),{isOpen:_,onOpen:E,onClose:w}=(0,l.j)();(0,h.useRef)(null);let I=(0,o.d)(),R=(0,b.useRouter)();(0,h.useRef)(null);let[A,N]=(0,h.useState)(!1),[B,C]=(0,h.useState)(null),[T,H]=(0,h.useState)([]),[D,P]=(0,h.useState)(!1),[L,U]=(0,h.useState)(null),[X,k]=(0,h.useState)(!1),[z,F]=(0,h.useState)(void 0),[M,G]=(0,h.useState)(void 0),[W,Z]=(0,h.useState)({}),[$,Q]=(0,h.useState)(""),[K,O]=(0,h.useState)("all"),[J,q]=(0,h.useState)(!1),[V,Y]=(0,h.useState)(""),[ee,et]=(0,h.useState)(null);return((0,h.useEffect)(()=>{let e=(0,p.hg)(x.j,async e=>{if(!e)return void R.replace("/login");let t=await (0,f.x7)((0,f.H9)(x.db,"users",e.uid)),a=t.exists()?t.data().role:"user";if(et(a),"admin"!==a){if("owner"===a)return void R.replace("/rooms");if("employee"===a)return void R.replace("/employee-dashboard");R.replace("/dashboard")}});return()=>e()},[]),(0,h.useEffect)(()=>{(async()=>{g(!0);try{let e=(await (0,f.GG)((0,f.rJ)(x.db,"rooms"))).docs.map(e=>{let t=e.data();return{id:e.id,status:t.status||"occupied",tenantName:t.tenantName||"-",area:t.area||0,latestTotal:t.latestTotal||0,electricity:t.electricity||0,water:t.water||0,rent:t.rent||0,service:t.service||0,overdueDays:t.overdueDays||0,billStatus:t.billStatus||"paid"}});t(e)}catch(e){I({title:"โหลดข้อมูลห้องพักล้มเหลว",status:"error"}),t([])}finally{g(!1)}})()},[I]),(0,h.useEffect)(()=>{async function t(){let t={};for(let a of e){let e=(0,f.P)((0,f.rJ)(x.db,"bills"),(0,f._M)("roomId","==",a.id),(0,f.My)("createdAt","desc"),(0,f.AB)(1)),r=await (0,f.GG)(e);if(!r.empty){let e,l=r.docs[0].data();e=0+Number(l.electricityTotal||0)+Number(l.waterTotal||0)+Number(l.rent||0)+Number(l.service||0),Array.isArray(l.extraServices)&&(e+=l.extraServices.reduce((e,t)=>e+Number(t.value||0),0)),t[a.id]={...l,total:e}}}Z(t)}e.length>0&&t()},[e]),e.filter(e=>{let t=e.id.toLowerCase().includes($.trim().toLowerCase())||e.tenantName.toLowerCase().includes($.trim().toLowerCase()),a=!0;return"unpaid"===K?a="unpaid"===e.billStatus:"vacant"===K&&(a="vacant"===e.status),t&&a}),null===ee)?(0,r.jsx)(s.o,{minH:"100vh",children:(0,r.jsx)(n.y,{color:"blue.400"})}):"admin"!==ee?null:(0,r.jsx)(m.A,{role:ee,children:(0,r.jsx)(i.s,{align:"center",justify:"center",flex:1,minH:"80vh",children:(0,r.jsxs)(u.a,{bg:"white",borderRadius:"2xl",boxShadow:"xl",p:12,textAlign:"center",children:[(0,r.jsx)(c.D,{fontSize:"3xl",color:"blue.600",mb:4,children:"Dashboard"}),(0,r.jsx)(d.E,{color:"gray.600",children:"สรุปข้อมูลภาพรวมระบบ (Coming soon...)"})]})})})}},2736:(e,t,a)=>{"use strict";a.d(t,{D:()=>u});var r=a(7876),l=a(9185),o=a(5255),s=a(9461),n=a(4013),i=a(6044);let u=(0,s.R)(function(e,t){let a=(0,n.V)("Heading",e),{className:s,...u}=(0,l.M)(e);return(0,r.jsx)(i.B.h2,{ref:t,className:(0,o.cx)("chakra-heading",e.className),...u,__css:a})});u.displayName="Heading"},3611:(e,t,a)=>{"use strict";a.d(t,{db:()=>d,j:()=>c});var r=a(6042),l=a(9917),o=a(2964),s=a(5226),n=a(5364);let i={apiKey:n.env.NEXT_PUBLIC_FIREBASE_API_KEY||"AIzaSyDtZQ_gX9xWqGQgxQMBzTH8c9o6t-ZsvKc",authDomain:n.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN||"raoteebaan.firebaseapp.com",databaseURL:n.env.NEXT_PUBLIC_FIREBASE_DATABASE_URL||"https://raoteebaan-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:n.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID||"raoteebaan",storageBucket:n.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET||"raoteebaan.appspot.com",messagingSenderId:n.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID||"986271509277",appId:n.env.NEXT_PUBLIC_FIREBASE_APP_ID||"1:986271509277:web:ff35142f2eabe2063c0ff4",measurementId:n.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID||"G-YW7ZP3B4TC"},u=(0,r.Dk)().length?(0,r.Dk)()[0]:(0,r.Wp)(i),c=(0,l.xI)(u),d=(0,o.aU)(u);(0,s.c7)(u)},4945:(e,t,a)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a.d(t,{A:()=>r})},5377:(e,t,a)=>{"use strict";a.d(t,{d:()=>u});var r=a(4232),l=a(3446),o=a(8259),s=a(1294),n=a(3519),i=a(6674);function u(e){let{theme:t}=(0,i.UQ)(),a=(0,n.NU)();return(0,r.useMemo)(()=>(function(e,t){let a=a=>({...t,...a,position:function(e,t){let a=e??"bottom";return({"top-start":{ltr:"top-left",rtl:"top-right"},"top-end":{ltr:"top-right",rtl:"top-left"},"bottom-start":{ltr:"bottom-left",rtl:"bottom-right"},"bottom-end":{ltr:"bottom-right",rtl:"bottom-left"}})[a]?.[t]??a}(a?.position??t?.position,e)}),r=e=>{let t=a(e),r=(0,o.q)(t);return s.Z.notify(r,t)};return r.update=(e,t)=>{s.Z.update(e,a(t))},r.promise=(e,t)=>{let a=r({...t.loading,status:"loading",duration:null});e.then(e=>r.update(a,{status:"success",duration:5e3,...(0,l.J)(t.success,e)})).catch(e=>r.update(a,{status:"error",duration:5e3,...(0,l.J)(t.error,e)}))},r.closeAll=s.Z.closeAll,r.close=s.Z.close,r.isActive=s.Z.isActive,r})(t.direction,{...a,...e}),[e,t.direction,a])}},6447:(e,t,a)=>{"use strict";a.d(t,{A:()=>b});var r=a(7876),l=a(9955),o=a(9803),s=a(8619),n=a(5812),i=a(8230),u=a.n(i),c=a(9099),d=a(2870);function h(e){let{role:t}=e,a=(0,c.useRouter)();return(0,r.jsxs)(l.a,{w:["70px","220px"],minH:"calc(100vh - 64px)",bg:"white",borderRight:"1.5px solid #e3f2fd",boxShadow:"0 2px 16px 0 rgba(33,150,243,0.06)",px:[1,4],py:6,display:"flex",flexDirection:"column",gap:4,zIndex:2,children:["admin"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u(),{href:"/dashboard",passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(n.$,{as:"a",leftIcon:(0,r.jsx)(d.rQ8,{}),colorScheme:"blue",variant:"/dashboard"===a.pathname?"solid":"ghost",borderRadius:"xl",fontWeight:"bold",mb:2,w:"full",justifyContent:"flex-start",children:"Dashboard"})}),(0,r.jsx)(u(),{href:"/rooms",passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(n.$,{as:"a",leftIcon:(0,r.jsx)(d.rQ8,{}),colorScheme:"blue",variant:"/rooms"===a.pathname?"solid":"ghost",borderRadius:"xl",fontWeight:"bold",mb:2,w:"full",justifyContent:"flex-start",children:"Rooms"})}),(0,r.jsx)(u(),{href:"/inbox",passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(n.$,{as:"a",leftIcon:(0,r.jsx)(d.opL,{}),colorScheme:"gray",variant:"/inbox"===a.pathname?"solid":"ghost",borderRadius:"xl",mb:2,w:"full",justifyContent:"flex-start",children:"Inbox"})}),(0,r.jsx)(u(),{href:"/parcel",passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(n.$,{as:"a",leftIcon:(0,r.jsx)(d.TXh,{}),colorScheme:"gray",variant:"/parcel"===a.pathname?"solid":"ghost",borderRadius:"xl",mb:2,w:"full",justifyContent:"flex-start",children:"Parcel"})}),(0,r.jsx)(u(),{href:"/employee",passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(n.$,{as:"a",leftIcon:(0,r.jsx)(d.M5n,{}),colorScheme:"gray",variant:"/employee"===a.pathname?"solid":"ghost",borderRadius:"xl",mb:8,w:"full",justifyContent:"flex-start",children:"Employee"})})]}),"owner"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u(),{href:"/rooms",passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(n.$,{as:"a",leftIcon:(0,r.jsx)(d.rQ8,{}),colorScheme:"blue",variant:"/rooms"===a.pathname?"solid":"ghost",borderRadius:"xl",fontWeight:"bold",mb:2,w:"full",justifyContent:"flex-start",children:"Rooms"})}),(0,r.jsx)(u(),{href:"/inbox",passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(n.$,{as:"a",leftIcon:(0,r.jsx)(d.opL,{}),colorScheme:"gray",variant:"/inbox"===a.pathname?"solid":"ghost",borderRadius:"xl",mb:2,w:"full",justifyContent:"flex-start",children:"Inbox"})}),(0,r.jsx)(u(),{href:"/parcel",passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(n.$,{as:"a",leftIcon:(0,r.jsx)(d.TXh,{}),colorScheme:"gray",variant:"/parcel"===a.pathname?"solid":"ghost",borderRadius:"xl",mb:8,w:"full",justifyContent:"flex-start",children:"Parcel"})})]})]})}var x=a(3042),f=a(9865);function b(e){let{children:t,role:a}=e;return(0,r.jsxs)(l.a,{minH:"100vh",children:[(0,r.jsx)(s.A,{}),(0,r.jsxs)(o.s,{minH:"100vh",p:0,children:[(0,r.jsx)(h,{role:a}),(0,r.jsx)(x.N,{mode:"wait",children:(0,r.jsx)(f.P.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},exit:{opacity:0,y:-24},transition:{duration:.35,ease:"easeInOut"},style:{flex:1},children:t},window.location.pathname)})]})]})}},7580:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return a(753)}])},8619:(e,t,a)=>{"use strict";a.d(t,{A:()=>b});var r=a(7876),l=a(9803),o=a(1921),s=a(7365),n=a(3782),i=a(9955),u=a(485),c=a(2870),d=a(9099),h=a(4232),x=a(3611),f=a(2964);function b(e){let{user:t}=e,a=(0,d.useRouter)(),[b,p]=(0,h.useState)({name:(null==t?void 0:t.name)||"xxx",avatar:null==t?void 0:t.avatar,greeting:null==t?void 0:t.greeting}),[m,g]=(0,h.useState)(null);return(0,h.useEffect)(()=>{let e=x.j.currentUser;e?(p({name:e.displayName||(null==t?void 0:t.name)||"xxx",avatar:e.photoURL||(null==t?void 0:t.avatar),greeting:new Date().toLocaleString("th-TH",{dateStyle:"full",timeStyle:"short"})}),(0,f.x7)((0,f.H9)(x.db,"users",e.uid)).then(e=>{g(e.exists()?e.data().role:"user")})):(p({name:(null==t?void 0:t.name)||"xxx",avatar:null==t?void 0:t.avatar,greeting:new Date().toLocaleString("th-TH",{dateStyle:"full",timeStyle:"short"})}),g(null))},[t]),(0,r.jsxs)(l.s,{as:"header",w:"full",px:[2,4,8],py:[2,3],align:"center",bg:"whiteAlpha.800",borderRadius:"2xl",boxShadow:"0 4px 24px 0 rgba(33, 150, 243, 0.10)",mt:[2,4],mb:[4,8],maxW:"100vw",minH:"64px",position:"relative",zIndex:10,style:{backdropFilter:"blur(12px)"},border:"1.5px solid #e3f2fd",children:[(0,r.jsx)(o.E,{fontWeight:"extrabold",fontSize:["lg","2xl"],color:"blue.500",mr:6,letterSpacing:1,children:"TeeRao"}),(0,r.jsx)(s.h,{}),(0,r.jsxs)(l.s,{align:"center",gap:3,children:[(0,r.jsx)(n.e,{size:"md",name:b.name||"",src:b.avatar,border:"2.5px solid white",boxShadow:"md",bg:"blue.100",color:"blue.700",cursor:"pointer",onClick:()=>a.push("/profile")}),(0,r.jsxs)(i.a,{textAlign:"left",cursor:"pointer",onClick:()=>a.push("/profile"),children:[(0,r.jsxs)(o.E,{fontWeight:"bold",fontSize:"md",color:"gray.800",children:["สวัสดีคุณ ",b.name||"xxx"]}),(0,r.jsx)(o.E,{fontSize:"xs",color:"gray.400",children:b.greeting||"อาทิตย์ 21 มิ.ย. 2568"})]}),"admin"===m&&(0,r.jsx)(u.K,{"aria-label":"Settings",icon:(0,r.jsx)(c.Pcn,{}),variant:"ghost",fontSize:"xl",color:"blue.500",_hover:{bg:"blue.50",color:"blue.600"},borderRadius:"full",onClick:()=>a.push("/admin-users")}),(0,r.jsx)(u.K,{"aria-label":"Notifications",icon:(0,r.jsx)(c.jNV,{}),variant:"ghost",fontSize:"xl",color:"blue.500",_hover:{bg:"blue.50",color:"blue.600"},borderRadius:"full"})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[671,871,347,465,169,71,936,636,593,792],()=>t(7580)),_N_E=e.O()}]);